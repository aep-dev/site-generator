---
id: 132
state: approved
created: 2019-01-22T00:00:00.000Z
updated: 2024-03-08T00:00:00.000Z
slug: list
placement:
  category: standard-methods
  order: 20
title: List

--- 
import { Aside, Tabs, TabItem } from '@astrojs/starlight/components';
import Sample from '../../components/Sample.astro';

# List

In REST APIs, it is customary to make a `GET` request to a resource
collection's URI (for example, `/v1/publishers/{publisher}/books`) in order to
retrieve a list of the resources within that collection.

Resource-oriented design (AEP-121) honors this pattern through the `List`
method. These RPCs accept the parent collection (and potentially some other
parameters), and return a list of responses matching that input.

## Guidance

APIs <b class="font-extrabold	text-yellow-700">should</b> provide a `List` method for resource collections.The purpose of
the `List` method is to return data from a finite collection (generally
singular unless the operation supports [reading across collections][]).

When the `GET` method is used on a URI ending in a resource collection, the
result <b class="font-extrabold	text-red-700">must</b> be a list of resources.

### Requests

`List` operations <b class="font-extrabold	text-red-700">must</b> be made by sending a `GET` request to the resource
collection's URI:

```http
GET /v1/publishers/{publisher}/books HTTP/2
Host: library.googleapis.com
Accept: application/json
```

- The HTTP method <b class="font-extrabold	text-red-700">must</b> be `GET`.
  - The request <b class="font-extrabold	text-red-700">must</b> be safe and <b class="font-extrabold	text-red-700">must not</b> have side effects.
- There <b class="font-extrabold	text-red-700">must not</b> be a request body.
  - If a `GET` request contains a body, the body <b class="font-extrabold	text-red-700">must</b> be ignored, and
    <b class="font-extrabold	text-red-700">must not</b> cause an error.
- The request <b class="font-extrabold	text-red-700">must not</b> require any fields in the query string.
  - The query string <b class="font-extrabold text-green-700">may</b> include fields for common design patterns relevant
    to list methods, such as `string filter` and `string orderBy`.
  - The query string <b class="font-extrabold text-green-700">may</b> include custom fields if necessary for a specific
    resource, but not in place of any of the common fields for list methods.

### Responses

`List` operations <b class="font-extrabold	text-red-700">must</b> return a page of results, with each individual
result being a resource:

```json
{
  "results": [
    {
      "name": "publishers/lacroix/books/les-mis",
      "isbn": "978-037-540317-0",
      "title": "Les Mis√©rables",
      "authors": ["Victor Hugo"],
      "rating": 9.6
    },
    {
      "name": "publishers/lacroix/books/hunchback-of-notre-dame",
      "isbn": "978-140-274575-1",
      "title": "The Hunchback of Notre Dame",
      "authors": ["Victor Hugo"],
      "rating": 9.3
    }
  ],
  "nextPageToken": "xyz"
}
```

- The array of resources <b class="font-extrabold	text-red-700">must</b> be named `results` and contain resources with
  no additional wrapping.
- The `string nextPageToken` field <b class="font-extrabold	text-red-700">must</b> be included in the list response
  schema. It <b class="font-extrabold	text-red-700">must</b> be set if there are subsequent pages, and <b class="font-extrabold	text-red-700">must not</b> be
  set if the response represents the final page. For more information, see
  AEP-158.
- The response struct <b class="font-extrabold text-green-700">may</b> include a `int32 totalSize` (or
  `int64 totalSize`) field with the number of items in the collection.
  - The value <b class="font-extrabold text-green-700">may</b> be an estimate (the field <b class="font-extrabold	text-yellow-700">should</b> clearly document
    this if so).
  - If filtering is used, the `totalSize` field <b class="font-extrabold	text-yellow-700">should</b> reflect the size of
    the collection _after_ the filter is applied.

<Aside type="note" title="Note">
  List methods <b class="font-extrabold text-green-700">may</b> return the complete collection to any user with
  permission to make a successful List request on the collection, _or_ <b class="font-extrabold text-green-700">may</b>
  return a collection only containing resources for which the user has read
  permission. This behavior <b class="font-extrabold	text-yellow-700">should</b> be clearly documented either for each List
  method or as a standard convention in service-level documentation. Permission
  checks on individual resources may have a negative performance impact so should
  be used only where absolutely necessary.
</Aside>

### Errors

If the user does not have sufficient permission to know that the collection
exists, the service <b class="font-extrabold	text-yellow-700">should</b> reply with an HTTP 404 error, regardless of
whether or not the collection exists. Permission <b class="font-extrabold	text-red-700">must</b> be checked prior to
checking whether the collection exists.

If the user does have proper permission, but the requested collection does not
exist (generally because the parent does not exist), the service <b class="font-extrabold	text-red-700">must</b> reply
with an HTTP 404 error.

<Aside type="note" title="Note">
  An empty collection which the user has permission to access <b class="font-extrabold	text-red-700">must</b>
  return `200 OK` with an empty results array, and not `404 Not Found`.
</Aside>

### Ordering

`List` methods <b class="font-extrabold text-green-700">may</b> allow clients to specify sorting order; if they do, the
request message <b class="font-extrabold	text-yellow-700">should</b> contain a `string orderBy` field.

- Values <b class="font-extrabold	text-yellow-700">should</b> be a comma separated list of fields. For example:
  `"foo,bar"`.
- The default sorting order is ascending. To specify descending order for a
  field, users append a `-` prefix; for example: `"foo,-bar"`, `"-foo,bar"`.
- Redundant space characters in the syntax are insignificant. `"foo, -bar"`,
  `" foo , -bar "`, and `"foo,-bar"` are all equivalent.
- Subfields are specified with a `.` character, such as `foo.bar` or
  `address.street`.

<Aside type="note" title="Note">
  Only include ordering if there is an established need to do so. It is
  always possible to add ordering later, but removing it is a breaking change.
</Aside>

### Filtering

List methods <b class="font-extrabold text-green-700">may</b> allow clients to specify filters; if they do, the request
message <b class="font-extrabold	text-yellow-700">should</b> contain a `string filter` field. Filtering is described in
more detail in AEP-160.

<Aside type="note" title="Note">
  Only include filtering if there is an established need to do so. It
  is always possible to add filtering later, but removing it is a breaking
  change.
</Aside>

### Soft-deleted resources

Some APIs need to "[soft-delete][]" resources, marking them as deleted or
pending deletion (and optionally purging them later).

APIs that do this <b class="font-extrabold	text-yellow-700">should not</b> include deleted resources by default in list
requests. APIs with soft deletion of a resource <b class="font-extrabold	text-yellow-700">should</b> include a
`bool showDeleted` field in the list request that, if set, will cause
soft-deleted resources to be included.

## Interface Definitions


<Tabs>
  <TabItem label="Protocol Buffers">
  
  
  List operations are specified using the following pattern:
  
  <Sample path="../aep.dev/aep/general/0132/list.proto" type="protobuf" token1="rpc ListBooks" token2="" />
  
  - The RPC's name <b class="font-extrabold	text-red-700">must</b> begin with the word `List`. The remainder of the RPC
    name <b class="font-extrabold	text-yellow-700">should</b> be the plural form of the resource's message name.
  - The request message <b class="font-extrabold	text-red-700">must</b> match the RPC name, with a `-Request` suffix.
  - The response message <b class="font-extrabold	text-red-700">must</b> match the RPC name, with a `-Response` suffix.
    - The response <b class="font-extrabold	text-yellow-700">should</b> usually include fully-populated resources unless
      there is a reason to return a partial response (see AEP-157).
  - The HTTP verb <b class="font-extrabold	text-red-700">must</b> be `GET`.
  - The URI <b class="font-extrabold	text-yellow-700">should</b> contain a single variable field corresponding to the
    collection parent's name.
    - This field <b class="font-extrabold	text-yellow-700">should</b> be called `parent`.
    - The URI <b class="font-extrabold	text-yellow-700">should</b> have a variable corresponding to this field.
    - The `parent` field <b class="font-extrabold	text-yellow-700">should</b> be the only variable in the URI path. All
      remaining parameters <b class="font-extrabold	text-yellow-700">should</b> map to URI query parameters.
  - There <b class="font-extrabold	text-red-700">must not</b> be a `body` key in the `google.api.http` annotation.
  - There <b class="font-extrabold	text-yellow-700">should</b> be exactly one `google.api.method_signature` annotation,
    with a value of `"parent"`.
  
  List operations also implement a common request message pattern:
  
  <Sample path="../aep.dev/aep/general/0132/list.proto" type="protobuf" token1="message ListBooksRequest" token2="" />
  
  - A `parent` field <b class="font-extrabold	text-red-700">must</b> be included unless the resource being listed is a
    top-level resource. It <b class="font-extrabold	text-yellow-700">should</b> be called `parent`.
    - The field <b class="font-extrabold	text-red-700">must</b> be [annotated as required][aep-203].
    - The field <b class="font-extrabold	text-red-700">must</b> identify the [resource type][] of the resource being
      listed with a `google.api.resource_reference` annotation.
  - The `max_page_size` and `page_token` fields, which support pagination,
    <b class="font-extrabold	text-red-700">must</b> be specified on all list request messages. For more information, see
    AEP-158.
  
  **Note:** The `parent` field in the request object corresponds to the `parent`
  variable in the `google.api.http` annotation on the RPC. This causes the
  `parent` field in the request to be populated based on the value in the URL
  when the REST/JSON interface is used.
  
  <Sample path="../aep.dev/aep/general/0132/list.proto" type="protobuf" token1="message ListBooksResponse" token2="" />
  
  - The response message <b class="font-extrabold	text-red-700">must</b> include a field corresponding to the resources
    being returned, named for the English plural term for the resource, and
    <b class="font-extrabold	text-yellow-700">should not</b> include any other repeated fields.
  - Fields providing metadata about the list request (such as
    `string next_page_token` or `int32 total_size`) <b class="font-extrabold	text-red-700">must</b> be included on the
    response message (not as part of the resource itself).
  
  
  </TabItem>
  <TabItem label="OpenAPI 3.0">
  
  
  `List` operations <b class="font-extrabold	text-red-700">must</b> be specified with consistent OpenAPI metadata:
  
  <Sample path="../aep.dev/aep/general/0132/list.oas.yaml" type="yml" token1="paths" token2="" />
  
  - The `operationId` <b class="font-extrabold	text-red-700">must</b> begin with the word `list`. The remainder of the
    `operationId` <b class="font-extrabold	text-yellow-700">should</b> be the plural form of the resource type's name.
  - The response content <b class="font-extrabold	text-red-700">must</b> be the resource itself. For example:
    `#/components/schemas/Book`
    - The response <b class="font-extrabold	text-yellow-700">should</b> usually include the fully-populated resource unless
      there is a reason to return a partial response (see AEP-157).
  - The URI <b class="font-extrabold	text-yellow-700">should</b> contain a variable for each individual ID in the resource
    hierarchy.
    - The path parameter for all resource IDs <b class="font-extrabold	text-red-700">must</b> be in the form
      `{resourceName}Id` (such as `bookId`), and path parameters representing the
      ID of parent resources <b class="font-extrabold	text-red-700">must</b> end with `Id`.
  
  
  </TabItem>
</Tabs>
    

{/* prettier-ignore-start  */}
[reading across collections]: ./0159
[soft-delete]: ./0164
[resource type]: ./0123
[aep-203]: ./0203
{/* prettier-ignore-end  */}
